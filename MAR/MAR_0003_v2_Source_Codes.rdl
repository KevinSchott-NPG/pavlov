<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="Tablix1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>3.11736cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.72319cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox10">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Number of Orders</Value>
                              <Style>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox10</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>DarkBlue</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.72319cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="distinct_count_orders">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Sum(Fields!distinct_count_orders.Value)</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Right</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>distinct_count_orders</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <TablixHeader>
                <Size>3.66417cm</Size>
                <CellContents>
                  <Textbox Name="Textbox12">
                    <CanGrow>true</CanGrow>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>Source Code</Value>
                            <Style>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Left</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>Textbox12</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <BackgroundColor>DarkBlue</BackgroundColor>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
              <KeepWithGroup>After</KeepWithGroup>
            </TablixMember>
            <TablixMember>
              <Group Name="source_code">
                <GroupExpressions>
                  <GroupExpression>=Fields!source_code.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!source_code.Value</Value>
                </SortExpression>
              </SortExpressions>
              <TablixHeader>
                <Size>3.66417cm</Size>
                <CellContents>
                  <Textbox Name="source_code1">
                    <CanGrow>true</CanGrow>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>=Fields!source_code.Value</Value>
                            <Style />
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Left</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>source_code1</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Details">
                    <GroupExpressions>
                      <GroupExpression>=Fields!source_code.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>dt_source_code</DataSetName>
        <SortExpressions>
          <SortExpression>
            <Value>=Fields!source_code.Value</Value>
          </SortExpression>
        </SortExpressions>
        <Top>2.78695cm</Top>
        <Left>0.37042cm</Left>
        <Height>1.44638cm</Height>
        <Width>6.78153cm</Width>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
      <Textbox Name="Textbox7">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Distinct Count of Orders per Source Code</Value>
                <Style>
                  <FontFamily>Tahoma</FontFamily>
                  <FontSize>18pt</FontSize>
                  <FontWeight>Normal</FontWeight>
                  <Color>DarkBlue</Color>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value xml:space="preserve">   </Value>
                <Style>
                  <FontFamily>Tahoma</FontFamily>
                  <Color>#1c3a70</Color>
                </Style>
              </TextRun>
              <TextRun>
                <Value>=Globals!ExecutionTime</Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                </Style>
              </TextRun>
              <TextRun>
                <Value> - </Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                </Style>
              </TextRun>
              <TextRun>
                <Value>=Globals!ReportName</Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                </Style>
              </TextRun>
              <TextRun>
                <Value>  -  from Eclipse Reporting</Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox7</rd:DefaultName>
        <Height>1.44639cm</Height>
        <Width>13.72716cm</Width>
        <ZIndex>1</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Textbox Name="Textbox2">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Shows a distinct count of all orders for each source code, excluding cancels</Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>=Iif((Parameters!orderfrom.Value &lt;&gt; nothing and Parameters!orderto.Value &lt;&gt; Nothing),
(" from " &amp;Parameters!orderfrom.Value &amp; " to " &amp; Parameters!orderto.Value)," for all time period")</Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox2</rd:DefaultName>
        <Top>1.48167cm</Top>
        <Height>1.30529cm</Height>
        <Width>13.72716cm</Width>
        <ZIndex>2</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Textbox Name="Textbox3">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Click here to show detailed list of all orders for selected source codes, excluding cancels</Value>
                <Style>
                  <TextDecoration>Underline</TextDecoration>
                  <Color>Blue</Color>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox3</rd:DefaultName>
        <ActionInfo>
          <Actions>
            <Action>
              <Drillthrough>
                <ReportName>MAR_0003_v2_Detailed_Circulation_for_Source_Codes</ReportName>
                <Parameters>
                  <Parameter Name="source_code">
                    <Value>=Parameters!source_code.Value</Value>
                  </Parameter>
                  <Parameter Name="orderfrom">
                    <Value>=Parameters!orderfrom.Value</Value>
                  </Parameter>
                  <Parameter Name="orderto">
                    <Value>=Parameters!orderto.Value</Value>
                  </Parameter>
                </Parameters>
              </Drillthrough>
            </Action>
          </Actions>
        </ActionInfo>
        <Top>4.79433cm</Top>
        <Height>0.6cm</Height>
        <Width>13.72716cm</Width>
        <ZIndex>3</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Textbox Name="Textbox4">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Net GBP by Source Code</Value>
                <Style>
                  <TextDecoration>Underline</TextDecoration>
                  <Color>Blue</Color>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox3</rd:DefaultName>
        <ActionInfo>
          <Actions>
            <Action>
              <Drillthrough>
                <ReportName>MAR_0003_v2_net_GBP_by_source_code</ReportName>
                <Parameters>
                  <Parameter Name="source_code">
                    <Value>=Parameters!source_code.Value</Value>
                  </Parameter>
                  <Parameter Name="orderfrom">
                    <Value>=Parameters!orderfrom.Value</Value>
                  </Parameter>
                  <Parameter Name="orderto">
                    <Value>=Parameters!orderto.Value</Value>
                  </Parameter>
                </Parameters>
              </Drillthrough>
            </Action>
          </Actions>
        </ActionInfo>
        <Top>6.17071cm</Top>
        <Height>0.6cm</Height>
        <Width>13.72716cm</Width>
        <ZIndex>4</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Textbox Name="Textbox5">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Charts &amp; Graphs</Value>
                <Style>
                  <FontWeight>Bold</FontWeight>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox5</rd:DefaultName>
        <Top>5.57071cm</Top>
        <Height>0.6cm</Height>
        <Width>13.72716cm</Width>
        <ZIndex>5</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Textbox Name="Textbox6">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Detailed Data</Value>
                <Style>
                  <FontWeight>Bold</FontWeight>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox5</rd:DefaultName>
        <Top>4.14169cm</Top>
        <Height>0.6cm</Height>
        <Width>13.72716cm</Width>
        <ZIndex>6</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Textbox Name="Textbox8">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Order Count by Source Code and Region</Value>
                <Style>
                  <TextDecoration>Underline</TextDecoration>
                  <Color>Blue</Color>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox3</rd:DefaultName>
        <ActionInfo>
          <Actions>
            <Action>
              <Drillthrough>
                <ReportName>MAR_0003_v2_order_count_by_source_code_region</ReportName>
                <Parameters>
                  <Parameter Name="source_code">
                    <Value>=Parameters!source_code.Value</Value>
                  </Parameter>
                  <Parameter Name="orderfrom">
                    <Value>=Parameters!orderfrom.Value</Value>
                  </Parameter>
                  <Parameter Name="orderto">
                    <Value>=Parameters!orderto.Value</Value>
                  </Parameter>
                </Parameters>
              </Drillthrough>
            </Action>
          </Actions>
        </ActionInfo>
        <Top>6.77071cm</Top>
        <Height>0.54708cm</Height>
        <Width>13.43612cm</Width>
        <ZIndex>7</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
    </ReportItems>
    <Height>4.54769in</Height>
    <Style />
  </Body>
  <Width>7.16481in</Width>
  <Page>
    <PageHeight>29.7cm</PageHeight>
    <PageWidth>21cm</PageWidth>
    <LeftMargin>2cm</LeftMargin>
    <RightMargin>2cm</RightMargin>
    <TopMargin>2cm</TopMargin>
    <BottomMargin>2cm</BottomMargin>
    <ColumnSpacing>0.13cm</ColumnSpacing>
    <Style />
  </Page>
  <Description>Distinct count of orders per source code</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="ds_eclipse_reporting">
      <DataSourceReference>ds_eclipse_reporting</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>969c2d2c-f5d1-4088-90df-657fcb840b9e</rd:DataSourceID>
    </DataSource>
    <DataSource Name="DataSource1">
      <DataSourceReference>ds_eclipse_live</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>537a9496-a811-4e38-bf64-d90fc27028d3</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="dt_source_code">
      <Query>
        <DataSourceName>ds_eclipse_reporting</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@source_code">
            <Value>=Parameters!source_code.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@orderfrom">
            <Value>=Parameters!orderfrom.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@orderto">
            <Value>=Parameters!orderto.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>
SELECT 
source_code, 
--oi.order_date, 
count(distinct oi.orderhdr_id) as distinct_count_orders
FROM order_item oi 
	inner join source_code sc on oi.source_code_id = sc.source_code_id
WHERE 
sc.[source_code] in (@source_code)
and (
	(@orderfrom is null)
	or
	(oi.order_date &gt;= @orderfrom)
)
and (
	(@orderto is null)
	or
	(oi.order_date  &lt; DATEADD(d,+1,@orderto))
)
and not(oi.order_status in (1,2,3,4))
GROUP BY sc.source_code,oi.order_date
order by oi.order_date desc</CommandText>
      </Query>
      <Fields>
        <Field Name="source_code">
          <DataField>source_code</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="distinct_count_orders">
          <DataField>distinct_count_orders</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="source_code">
      <DataType>String</DataType>
      <Prompt>Enter source codes (in Upper case)</Prompt>
      <MultiValue>true</MultiValue>
      <UsedInQuery>False</UsedInQuery>
    </ReportParameter>
    <ReportParameter Name="orderfrom">
      <DataType>DateTime</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <Values>
          <Value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" />
        </Values>
      </DefaultValue>
      <Prompt>Order Date From</Prompt>
    </ReportParameter>
    <ReportParameter Name="orderto">
      <DataType>DateTime</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <Values>
          <Value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" />
        </Values>
      </DefaultValue>
      <Prompt>Order Date To (inclusive)</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>beed56f0-f0b3-47d3-8a2f-8fee4bdc2a76</rd:ReportID>
</Report>